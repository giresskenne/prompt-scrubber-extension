(()=>{"use strict";(()=>{const e=[{id:"aws_access_key",pattern:new RegExp("(?<![A-Z0-9])[A-Z0-9]{20}(?![A-Z0-9])","g"),replacer:()=>"AKIA****************"},{id:"aws_secret_key",pattern:new RegExp("(?<![A-Za-z0-9\\/+=])[A-Za-z0-9\\/+=]{40}(?![A-Za-z0-9\\/+=])","g"),replacer:()=>"<AWS_SECRET_KEY-REDACTED>"},{id:"stripe_secret",pattern:new RegExp("(sk_live|sk_test)_[0-9a-zA-Z]{24}","g"),replacer:(e,...t)=>"$1_********************".replace("$&",e).replace(/\$(\d)/g,((e,n)=>t[n-1]||""))},{id:"credit_card",pattern:new RegExp("\\b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|6(?:011|5[0-9]{2})[0-9]{12})\\b","g"),replacer:()=>"<CREDIT_CARD-REDACTED>"},{id:"email",pattern:new RegExp("[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}","i"),replacer:()=>"<EMAIL-REDACTED>"},{id:"ipv4",pattern:new RegExp("\\b(?:(?:2(?:5[0-5]|[0-4][0-9])|1?[0-9]{1,2})\\.){3}(?:2(?:5[0-5]|[0-4][0-9])|1?[0-9]{1,2})\\b","g"),replacer:()=>"<IPV4-REDACTED>"},{id:"canadian_sin",pattern:new RegExp("\\b[0-9]{3}[- ]?[0-9]{3}[- ]?[0-9]{3}\\b","g"),replacer:()=>"<CANADIAN_SIN-REDACTED>"},{id:"us_social_security_number",pattern:new RegExp("\\b\\d{3}-?\\d{2}-?\\d{4}\\b","g"),replacer:()=>"<US_SOCIAL_SECURITY_NUMBER-REDACTED>"},{id:"us_phone_number",pattern:new RegExp("\\b\\(?\\d{3}\\)?[-. ]?\\d{3}[-. ]?\\d{4}\\b","g"),replacer:()=>"<US_PHONE_NUMBER-REDACTED>"},{id:"uk_national_insurance_number",pattern:new RegExp("\\b[A-Z]{2}[0-9]{6}[A-Z]?\\b","g"),replacer:()=>"<UK_NATIONAL_INSURANCE_NUMBER-REDACTED>"},{id:"uk_passport_number",pattern:new RegExp("\\b[A-PR-WY][0-9]{7}\\b","g"),replacer:()=>"<UK_PASSPORT_NUMBER-REDACTED>"},{id:"uk_nhs_number",pattern:new RegExp("\\b[0-9]{3} [0-9]{3} [0-9]{3}\\b","g"),replacer:()=>"<UK_NHS_NUMBER-REDACTED>"},{id:"uk_driving_license_number",pattern:new RegExp("\\b[A-Z]{2}[0-9]{6}[A-Z]?\\b","g"),replacer:()=>"<UK_DRIVING_LICENSE_NUMBER-REDACTED>"},{id:"uk_bank_account_number",pattern:new RegExp("\\b[0-9]{8}\\b","g"),replacer:()=>"<UK_BANK_ACCOUNT_NUMBER-REDACTED>"}];"undefined"!=typeof window&&(window.PromptScrubberRedactor={redact:function(t){let n=t,r=Object.create(null);for(const t of e){const e=n;n=n.replace(t.pattern,t.replacer),e!==n&&(r[t.id]=(r[t.id]||0)+1)}return{clean:n,stats:r}},rules:e})})(),(()=>{const e=e=>e.replace(/[&<>\"']/g,(e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[e])));function t(t,n,r){const i=function(e){if(e._psOverlay)return e._psOverlay;const t=document.createElement("div");t.className="ps-overlay",function(e,t){const n=getComputedStyle(e);["font","fontFamily","fontSize","fontWeight","lineHeight","letterSpacing","wordSpacing","whiteSpace","wordBreak","tabSize","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","textIndent"].forEach((e=>t.style[e]=n[e]))}(e,t),function(e){if(e.parentNode?.classList.contains("ps-wrapper"))return e.parentNode;const t=document.createElement("div");return t.className="ps-wrapper",t.style.position="relative",e.parentNode.insertBefore(t,e),t.appendChild(e),t}(e).appendChild(t);const n=()=>{t.style.width=e.clientWidth+"px",t.style.height=e.clientHeight+"px",t.scrollTop=e.scrollTop};return n(),e.addEventListener("scroll",n),new ResizeObserver(n).observe(e),e._psOverlay=t}(t);if(!r.length)return void(i.innerHTML="");r.sort(((e,t)=>e.start-t.start));let a="",s=0;for(const{start:t,end:i}of r)a+=e(n.slice(s,t)),a+=`<span class="ps-hl">${e(n.slice(t,i))}</span>`,s=i;a+=e(n.slice(s)),i.innerHTML=a}!function(){if(document.getElementById("psCSS"))return;const e=document.createElement("style");e.id="psCSS",e.textContent="\n    .ps-wrapper{position:relative;}\n    .ps-overlay{position:absolute;top:0;left:0;width:100%;height:100%;\n                pointer-events:none;white-space:pre-wrap;word-break:break-word;\n                color:transparent;font:inherit;line-height:inherit;padding:inherit;}\n    .ps-hl{text-decoration:underline wavy #004aad;color:inherit;}\n  ",document.head.appendChild(e)}();const n=new RegExp(["\\bAKIA[0-9A-Z]{12,20}\\b","\\b(?:sk|gh[pous]|gitpat)[-_][A-Za-z0-9]{20,}\\b","[A-Za-z0-9._%+-]+@[^\\s@]+\\.[A-Za-z]{2,}","\\b(?:\\d{1,3}\\.){3}\\d{1,3}\\b","\\b(?:\\d{4}[-\\s]?){3}\\d{4}\\b"].join("|"),"gi");let r=!1;chrome.runtime.sendMessage({type:"ping"},(e=>{e?.ready&&(r=!0)}));let i=null;function a(e){const t="TEXTAREA"===e.tagName?e.value:e.innerText,{clean:n,stats:r}=self.PromptScrubberRedactor.redact(t);"TEXTAREA"===e.tagName?(Object.getOwnPropertyDescriptor(HTMLTextAreaElement.prototype,"value").set.call(e,n),e.dispatchEvent(new Event("input",{bubbles:!0}))):e.innerText=n;const i=Object.values(r).reduce(((e,t)=>e+t),0);!function(e){const t=Object.assign(document.body.appendChild(document.createElement("div")),{textContent:e,style:"position:fixed;bottom:120px;right:24px;padding:8px 12px;background:#111;color:#fff;border-radius:6px;font:14px/1 sans-serif;z-index:9999;opacity:0;transition:opacity .3s;"});requestAnimationFrame((()=>t.style.opacity="0.9")),setTimeout((()=>{t.style.opacity="0",setTimeout((()=>t.remove()),300)}),2e3)}(i?`${i} sensitive items masked`:"No sensitive items detected"),n.trim()||s(e)}function s(e){e._psOverlay&&(e._psOverlay.innerHTML="");const t=document.getElementById("scrubSendBtn");t&&t.remove(),i=null}document.addEventListener("input",(async e=>{if(!(e=>e&&("TEXTAREA"===e.tagName||e.isContentEditable||"textbox"===e.getAttribute("role")))(e.target))return;const p=e.target,o="TEXTAREA"===p.tagName?p.value:p.innerText;if(!o.trim())return void s(p);i=p;const c=[];let d;for(n.lastIndex=0;d=n.exec(o);)c.push({start:d.index,end:d.index+d[0].length});var l;t(p,o,c),r&&t(p,o,await(l=o,new Promise((e=>chrome.runtime.sendMessage({type:"scan",text:l},e))))),function(e){if(document.getElementById("scrubSendBtn"))return;const t=document.createElement("button");t.id="scrubSendBtn",t.type="button",t.innerHTML=`<img src="${chrome.runtime.getURL("icons/logo.png")}" width="16" height="16"\n                   style="vertical-align:middle;margin-right:4px"> Scrub`,Object.assign(t.style,{margin:"2px 8px",padding:"2px 8px 2px 6px",fontSize:"12px",border:"1px solid #d0d7de",borderRadius:"10px",background:"#fff",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:"4px"}),t.onclick=()=>a(e),e.parentElement.insertBefore(t,e.nextSibling)}(p)}),!0),document.addEventListener("keydown",(e=>{e.altKey&&e.shiftKey&&"s"===e.key.toLowerCase()&&i&&(e.preventDefault(),a(i))}),!0)})()})();